<div *ngIf="game">
  <mat-toolbar style="background-color: #f0f0f5">
    <span>Exercise : {{game.exercise.title}} -> {{game.exercise.id}}</span>

  </mat-toolbar>

  <br/>

  <div class="container" fxLayout="row" fxLayoutGap="10px">

    <div fxFlex="30">
      <div fxLayout="column" fxLayoutGap="10px">

        <div fxFlex="50" style="text-align: center;">
          <h3>Description</h3>
          <hr>
          <p>{{game.exercise.description}}</p>
        </div>

        <div fxFlex="50">
          <mat-card>
            <mat-card-header>Chat</mat-card-header>
            <hr>
            <mat-card-content [style.overflow]="'auto'" [style.height.px]="'200'">
              <ul>
                <li *ngFor="let message of this.chat.messages">{{message.user.userName}} : {{message.text}}</li>
              </ul>
            </mat-card-content>

            <form [formGroup]="chatForm" (ngSubmit)="sendMessage()">
              <div>
                <mat-form-field class="full-width-input" fxFill>
                  <mat-label>Message</mat-label>
                  <textarea matInput #message maxlength="256" formControlName="message" placeholder="Ex. Hello..." required> </textarea>
                  <mat-hint align="start">
                    <strong>Don't disclose personal info</strong>
                  </mat-hint>
                  <mat-hint align="end">{{message.value.length}} / 256</mat-hint>
                  <mat-error>
                    Please provide a valid text
                  </mat-error>
                </mat-form-field>
              </div>

              <br/>

              <div fxLayout="row">
                <div fxFlex="50" fxLayoutAlign="start center">
                  <a mat-raised-button color="primary" (click)="sendMessage()">Send</a>
                </div>
                <div fxFlex="50" fxLayoutAlign="end center">
                  <div class="chat-users-text">
                    <i>In chat :</i>
                    <div class="chat-users" *ngFor="let userInGame of game.usersInGame; let i=index">
                      {{userInGame.user.userName}}<span *ngIf="i != game.usersInGame.length - 1">,</span>
                    </div>
                  </div>
                </div>
              </div>
            </form>

          </mat-card>
        </div>
      </div>
    </div>

    <div fxFlex="70">


      <div fxLayout="row">

        <div fxFlex="50" fxLayoutAlign="start center">
          <mat-form-field appearance="fill">
            <mat-label>Select a theme</mat-label>
            <mat-select [(ngModel)]="theme" (ngModelChange)="changeTheme()">
              <mat-option *ngFor="let theme of themes" [value]="theme.value">
                {{theme.viewValue}}
              </mat-option>
            </mat-select>
          </mat-form-field>
        </div>

        <div fxFlex="50" fxLayoutAlign="end center">
          <mat-icon>timer</mat-icon>

          <div style="margin: 10px">
            <span>Timer : {{timerValue - 1}}s</span>
          </div>
        </div>
      </div>

      <ngx-codemirror
        [options]="options"
        [ngModel]="content"
        [disabled]="readOnly"
        [autoFocus]="true"
        (ngModelChange)="handleChange($event)">
      </ngx-codemirror>

      <label class="btn btn-light" [class.active]="readOnly">
        <mat-checkbox class="example-margin" [(ngModel)]="readOnly">Toggle read-only mode (currently {{ readOnly ? 'on' : 'off' }})</mat-checkbox>
      </label>

      <br />

      <button mat-raised-button color="primary" (click)="compile()">Compile</button>
    </div>
  </div>

  <br/>

  <mat-card class="simple-card-inverse">
    <span>Compilation</span>
    <hr>
    <div *ngIf="this.loading === true" fxLayout="row" fxLayoutAlign="center center">
      <mat-spinner class="m-10"></mat-spinner>
    </div>
    <div *ngIf="this.loading !== true">
      <p>{{result}}</p>
    </div>
  </mat-card>
</div>
